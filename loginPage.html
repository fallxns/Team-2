<!-- This is an HTML document for a login form -->
<!DOCTYPE html>
<html>
    <head>
        <title>Login</title>
        <!-- Include jQuery library -->
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        
        <!-- Validate email function -->
        <script>
            async function validateEmails(event) {
                try {
                    event.preventDefault(); // Prevent form submission
                    
                    // Get email and password values
                    let email = document.getElementById("email").value;
                    let password = document.getElementById("password").value;
                    
                    // Fetch API endpoint for login with email and password
                    const response = await fetch(`http://localhost:3000/api/login`);
                    const data = await response.json(); // Parse the response as JSON
                    
                    // Update the HTML element with the API response
                    let employeeData = data;
                    let found = false;
                    
                    for (let employee in employeeData) {
                        if (employeeData[employee]["email"] == email && employeeData[employee]["password"] == password) {
                            found = true;
                            break;
                        }
                    }
                    
                    console.log(found);
                    // If found variable is true, submit the form
                    if (found === true) {
                        document.getElementById("login").submit(); // Submit the form
                    } else {
                        alert("Invalid Details");
                    }
                } catch (error) {
                    console.error('Error:', error);
                }
            }
        </script>
    </head>

    <body>
        <!-- Login form -->
        <form action="homepage.html" method="post" onsubmit="validateEmails(event)" id="login">
            <!-- Email input field -->
            <label class="form-label" for="email">Email Address</label>
            <input class="form-control" type="email" id="email" required>
            
            <!-- Password input field -->
            <label class="form-label" for="password">Password</label>
            <input class="form-control" type="password" id="password" required>

            <!-- Hidden input field to store user information -->
            <input type="hidden" id="userInfo" name="userInfo" value="">

            <!-- Sign in button -->
            <input type="submit" value="SIGN IN">
        </form>
    </body>
</html>
